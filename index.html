<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InstaParser PRO - –ê–Ω–∞–ª–∏–∑ Instagram</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .analyzer-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        .tab {
            padding: 12px 24px;
            background: #f8f9fa;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab:hover {
            transform: translateY(-2px);
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e1e1e1;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        button:hover {
            transform: translateY(-2px);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .results {
            margin-top: 30px;
        }

        .section {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .stats {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .post-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }

        .hashtag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .hashtag {
            background: #e9ecef;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            display: none;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #ffebee;
            padding: 20px;
            border-radius: 10px;
            color: #c53030;
            margin-top: 20px;
        }

        .info {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .insight-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .account-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }

        .score-badge {
            background: #ffd700;
            color: #000;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
            display: inline-block;
            margin-left: 10px;
        }

        .premium-badge {
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 8px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            text-align: center;
        }

        .feature-card.premium {
            border-color: #ffa726;
            background: linear-gradient(135deg, #fff3e0, #fff);
        }

        .month-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .month-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e9ecef;
        }

        .month-item.active {
            background: #667eea;
            color: white;
        }

        @media (max-width: 768px) {
            .input-group {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .month-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç InstaParser PRO</h1>
            <p>–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ Instagram –∞–∫–∫–∞—É–Ω—Ç–æ–≤</p>
        </div>

        <div class="analyzer-card">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('single')">–ê–Ω–∞–ª–∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</button>
                <button class="tab" onclick="switchTab('compare')">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ</button>
                <button class="tab" onclick="switchTab('premium')">–ü—Ä–µ–º–∏—É–º —Ñ—É–Ω–∫—Ü–∏–∏</button>
            </div>

            <!-- –û–î–ò–ù –ê–ö–ö–ê–£–ù–¢ -->
            <div id="single-tab" class="tab-content">
                <div class="input-group">
                    <input type="text" id="username" placeholder="–í–≤–µ–¥–∏—Ç–µ Instagram username (–±–µ–∑ @)" value="instagram">
                    <button onclick="analyzeAccount()" id="analyzeBtn">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </div>

            <!-- –°–†–ê–í–ù–ï–ù–ò–ï -->
            <div id="compare-tab" class="tab-content" style="display: none;">
                <div class="input-group">
                    <input type="text" id="username1" placeholder="–ü–µ—Ä–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç" value="instagram">
                    <input type="text" id="username2" placeholder="–í—Ç–æ—Ä–æ–π –∞–∫–∫–∞—É–Ω—Ç" value="natgeo">
                    <button onclick="compareAccounts()" id="compareBtn">–°—Ä–∞–≤–Ω–∏—Ç—å</button>
                </div>
            </div>

            <!-- –ü–†–ï–ú–ò–£–ú -->
            <div id="premium-tab" class="tab-content" style="display: none;">
                <div class="info">
                    <h3>üöÄ –ü—Ä–µ–º–∏—É–º —Ñ—É–Ω–∫—Ü–∏–∏</h3>
                    <p>–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞</p>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>üìà –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h4>
                            <p>–¢—Ä–µ–Ω–¥—ã —Ä–æ—Å—Ç–∞ –∑–∞ 90 –¥–Ω–µ–π</p>
                            <div class="premium-badge">PREMIUM</div>
                        </div>
                        <div class="feature-card">
                            <h4>üîî –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤</h4>
                            <p>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏—Ö —É—Å–ø–µ—Ö–∞—Ö</p>
                            <div class="premium-badge">PREMIUM</div>
                        </div>
                        <div class="feature-card">
                            <h4>üéØ AI –ü—Ä–æ–≥–Ω–æ–∑—ã</h4>
                            <p>–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ä–æ—Å—Ç–∞ –∏ –¥–æ—Ö–æ–¥–∞</p>
                            <div class="premium-badge">PREMIUM</div>
                        </div>
                        <div class="feature-card">
                            <h4>üìã –ö–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω</h4>
                            <p>–ì–æ—Ç–æ–≤—ã–π –ø–ª–∞–Ω –Ω–∞ –º–µ—Å—è—Ü</p>
                            <div class="premium-badge">PREMIUM</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>–ü–æ–ª—É—á–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Instagram...</p>
            </div>

            <div class="results" id="results">
                <div class="info">
                    <h3>üí° –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</h3>
                    <ol style="margin: 10px 0; padding-left: 20px;">
                        <li>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –∞–Ω–∞–ª–∏–∑–∞ (–æ–¥–∏–Ω –∞–∫–∫–∞—É–Ω—Ç –∏–ª–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ)</li>
                        <li>–í–≤–µ–¥–∏—Ç–µ username Instagram</li>
                        <li>–ü–æ–ª—É—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É</li>
                    </ol>
                    <p><strong>‚ö†Ô∏è –í–∞–∂–Ω–æ:</strong> –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –ø—É–±–ª–∏—á–Ω—ã–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // üî• –¢–í–û–ô GOOGLE SCRIPT URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyGAwyQNRHJRJCeXApgB_PcYnKAit4Jrs4HD293LIhMQzQj0UxK3natnXWVJFpuH4os/exec';

        let currentTab = 'single';

        function switchTab(tab) {
            currentTab = tab;
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ç–∞–±—ã
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —Ç–∞–±
            document.getElementById(tab + '-tab').style.display = 'block';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
            document.querySelectorAll('.tab').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            document.getElementById('results').innerHTML = `
                <div class="info">
                    <h3>üí° –†–µ–∂–∏–º: ${tab === 'single' ? '–ê–Ω–∞–ª–∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞' : tab === 'compare' ? '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤' : '–ü—Ä–µ–º–∏—É–º —Ñ—É–Ω–∫—Ü–∏–∏'}</h3>
                    <p>–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</p>
                </div>
            `;
        }

        async function analyzeAccount() {
            const username = document.getElementById('username').value.trim();
            const analyzeBtn = document.getElementById('analyzeBtn');
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');

            if (!username) {
                showMessage('–í–≤–µ–¥–∏—Ç–µ username Instagram', 'error');
                return;
            }

            analyzeBtn.disabled = true;
            loading.style.display = 'block';
            results.innerHTML = '';

            try {
                const response = await fetch(`${GOOGLE_SCRIPT_URL}?username=${encodeURIComponent(username)}`);
                const data = await response.json();
                
                if (data.success) {
                    displaySingleResults(data);
                } else {
                    showMessage(data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞', 'error');
                }
            } catch (error) {
                showMessage('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + error.message, 'error');
            }

            analyzeBtn.disabled = false;
            loading.style.display = 'none';
        }

        async function compareAccounts() {
            const username1 = document.getElementById('username1').value.trim();
            const username2 = document.getElementById('username2').value.trim();
            const compareBtn = document.getElementById('compareBtn');
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');

            if (!username1 || !username2) {
                showMessage('–í–≤–µ–¥–∏—Ç–µ –æ–±–∞ username', 'error');
                return;
            }

            compareBtn.disabled = true;
            loading.style.display = 'block';
            results.innerHTML = '';

            try {
                const [data1, data2] = await Promise.all([
                    fetch(`${GOOGLE_SCRIPT_URL}?username=${encodeURIComponent(username1)}`).then(r => r.json()),
                    fetch(`${GOOGLE_SCRIPT_URL}?username=${encodeURIComponent(username2)}`).then(r => r.json())
                ]);

                if (data1.success && data2.success) {
                    displayComparisonResults(data1, data2);
                } else {
                    showMessage('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–æ–≤', 'error');
                }
            } catch (error) {
                showMessage('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + error.message, 'error');
            }

            compareBtn.disabled = false;
            loading.style.display = 'none';
        }

        function displaySingleResults(data) {
            const results = document.getElementById('results');
            
            // üî• –ë–ï–ó–û–ü–ê–°–ù–´–ô –†–ê–°–ß–ï–¢ –ê–ù–ê–õ–ò–¢–ò–ö–ò
            const videoPercentage = calculateVideoPercentage(data.top_posts || []);
            const photoPercentage = calculatePhotoPercentage(data.top_posts || []);
            const avgLikes = calculateAvgLikes(data.top_posts || []);
            const engagementRate = calculateEngagementRate(data);
            const bestContentType = getBestContentType(data.top_posts || []);
            const topHashtags = getTopHashtags(data.popular_hashtags || []);
            const successScore = calculateSuccessScore(data);
            const captionAnalysis = analyzeCaptions(data.top_posts || []);
            
            let html = `
                <div class="stats">
                    <h2>üìä ${data.username ? '@' + data.username : '–ê–∫–∫–∞—É–Ω—Ç'} <span class="score-badge">${successScore}/10</span></h2>
                    <p><strong>${data.full_name || ''}</strong></p>
                    <div style="display: flex; gap: 20px; margin-top: 10px; flex-wrap: wrap;">
                        <span>üë• ${(data.followers || 0).toLocaleString()} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</span>
                        <span>üìù ${data.posts_count || 0} –ø–æ—Å—Ç–æ–≤</span>
                        <span>üïí ${data.analyzed_at || new Date().toLocaleString('ru-RU')}</span>
                    </div>
                </div>
            `;
            
            // üî• –ö–õ–Æ–ß–ï–í–´–ï –ò–ù–°–ê–ô–¢–´
            html += `
                <div class="section">
                    <h3 class="section-title">üíé –ö–õ–Æ–ß–ï–í–´–ï –ò–ù–°–ê–ô–¢–´</h3>
                    
                    <div class="insight-card">
                        <strong>üéØ –§–æ—Ä–º—É–ª–∞ —É—Å–ø–µ—Ö–∞:</strong>
                        <p>–ê–∫–∫–∞—É–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ${videoPercentage}% –≤–∏–¥–µ–æ –∏ ${photoPercentage}% —Ñ–æ—Ç–æ –≤ —Ç–æ–ø-–ø–æ—Å—Ç–∞—Ö</p>
                    </div>
                    
                    <div class="insight-card">
                        <strong>üìà –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞:</strong>
                        <p>–°—Ä–µ–¥–Ω–∏–µ –ª–∞–π–∫–∏: ${avgLikes} | –í–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å: ${engagementRate}%</p>
                    </div>
                    
                    <div class="insight-card">
                        <strong>üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</strong>
                        <p>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –±–æ–ª—å—à–µ ${bestContentType} –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞</p>
                    </div>
                </div>
            `;
            
            // üî• –î–ï–¢–ê–õ–¨–ù–ê–Ø –ê–ù–ê–õ–ò–¢–ò–ö–ê
            html += `
                <div class="section">
                    <h3 class="section-title">üìä –î–ï–¢–ê–õ–¨–ù–ê–Ø –ê–ù–ê–õ–ò–¢–ò–ö–ê</h3>
                    <div class="post-card">
                        <strong>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å–ø–µ—à–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤</strong>
                        <small style="color: #666; display: block; margin-bottom: 10px;">
                            üí° –ê–Ω–∞–ª–∏–∑ –≤–∞—à–∏—Ö —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π
                        </small>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>üé¨ –í–∏–¥–µ–æ/Reels: ${videoPercentage}% —É—Å–ø–µ—à–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤</li>
                            <li>üì∑ –§–æ—Ç–æ: ${photoPercentage}% —É—Å–ø–µ—à–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤</li>
                            <li>‚ù§Ô∏è –°—Ä–µ–¥–Ω–∏–µ –ª–∞–π–∫–∏: ${avgLikes} –Ω–∞ –ø–æ—Å—Ç</li>
                            <li>üìà –í–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å: ${engagementRate}% (–ª–∞–π–∫–∏ + –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏)</li>
                            <li>‚≠ê Score —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏: ${successScore}/10</li>
                            <li>‚úçÔ∏è –î–ª–∏–Ω–∞ –æ–ø–∏—Å–∞–Ω–∏–π: ${captionAnalysis.avg_length} —Å–∏–º–≤–æ–ª–æ–≤</li>
                            <li>üòä –≠–º–æ–¥–∑–∏ –≤ ${captionAnalysis.emoji_percentage}% –ø–æ—Å—Ç–æ–≤</li>
                        </ul>
                    </div>
                </div>
            `;
            
            // üî• –ê–ù–ê–õ–ò–ó –£–°–ü–ï–®–ù–´–• –ü–£–ë–õ–ò–ö–ê–¶–ò–ô
            const timingAnalysis = analyzePostTiming(data.top_posts || []);
            html += `
                <div class="section">
                    <h3 class="section-title">üìÖ –ê–ù–ê–õ–ò–ó –£–°–ü–ï–®–ù–´–• –ü–£–ë–õ–ò–ö–ê–¶–ò–ô</h3>
                    
                    <div class="post-card">
                        <strong>üìä –¢–æ–ø-12 –ø–æ—Å—Ç–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 12 –º–µ—Å—è—Ü–µ–≤</strong>
                        <small style="color: #666; display: block; margin-bottom: 10px;">
                            üí° –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∞–º—ã–µ —É—Å–ø–µ—à–Ω—ã–µ –ø–æ—Å—Ç—ã —Å —Ö–µ—à—Ç–µ–≥–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
                        </small>
                        ${timingAnalysis.posts_stats}
                    </div>
                    
                    <div class="post-card">
                        <strong>üìà –í—ã–≤–æ–¥—ã –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏</strong>
                        <small style="color: #666; display: block; margin-bottom: 10px;">
                            üí° –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤ –∫–∞–∫–∏–µ –¥–Ω–∏ –≤–∞—à–∏ –ø–æ—Å—Ç—ã –Ω–∞–±–∏—Ä–∞—é—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ª–∞–π–∫–æ–≤
                        </small>
                        ${timingAnalysis.days_analysis}
                    </div>
                    
                    <div class="post-card">
                        <strong>üóìÔ∏è –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (12 –º–µ—Å—è—Ü–µ–≤)</strong>
                        <small style="color: #666; display: block; margin-bottom: 10px;">
                            üí° –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤ –∫–∞–∫–∏–µ –º–µ—Å—è—Ü—ã –≤–∞—à –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–∏—Ä–∞–ª—å–Ω—ã–º
                        </small>
                        ${timingAnalysis.months_analysis}
                    </div>
                    
                    <div class="post-card">
                        <strong>üé¨ –¢–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ –¥–Ω—è–º</strong>
                        <small style="color: #666; display: block; margin-bottom: 10px;">
                            üí° –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫–æ–π —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ) —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ –≤ —Ä–∞–∑–Ω—ã–µ –¥–Ω–∏
                        </small>
                        ${timingAnalysis.content_analysis}
                    </div>
                </div>
                
                <div class="section">
                    <h3 class="section-title">üöÄ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –î–õ–Ø –ü–£–ë–õ–ò–ö–ê–¶–ò–ô</h3>
                    <div class="post-card">
                        <strong>üìÖ –õ—É—á—à–∏–µ –¥–Ω–∏ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</strong>
                        <small style="color: #666; display: block; margin-bottom: 10px;">
                            üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –¥–Ω–∏ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–∏—Ö —Ç–æ–ø-–ø–æ—Å—Ç–æ–≤
                        </small>
                        ${timingAnalysis.days_recommendation}
                        
                        <strong>üé¨ –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞</strong>
                        <small style="color: #666; display: block; margin-bottom: 10px;">
                            üí° –ü–æ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ –∫–∞–∂–¥—ã–π –∏–∑ —É—Å–ø–µ—à–Ω—ã—Ö –¥–Ω–µ–π
                        </small>
                        ${timingAnalysis.content_recommendation}
                        
                        <strong>üìà –°–µ–∑–æ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã</strong>
                        <small style="color: #666; display: block; margin-bottom: 10px;">
                            üí° –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ª—É—á—à–∏–µ –ø–µ—Ä–∏–æ–¥—ã –¥–ª—è –≤–∏—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                        </small>
                        ${timingAnalysis.season_recommendation}
                    </div>
                </div>
            `;
            
            // üî• –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –î–õ–Ø –†–û–°–¢–ê
            html += `
                <div class="section">
                    <h3 class="section-title">üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –î–õ–Ø –†–û–°–¢–ê</h3>
                    <div class="post-card">
                        <strong>–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ ${(data.top_posts || []).length} —É—Å–ø–µ—à–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤</strong>
                        <small style="color: #666; display: block; margin-bottom: 10px;">
                            üí° –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏
                        </small>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>‚úÖ –î–µ–ª–∞–π—Ç–µ –±–æ–ª—å—à–µ <strong>${bestContentType}</strong> –∫–æ–Ω—Ç–µ–Ω—Ç–∞</li>
                            <li>‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ö–µ—à—Ç–µ–≥–∏: <strong>${topHashtags}</strong></li>
                            <li>‚úÖ ${captionAnalysis.emoji_percentage > 50 ? '–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–º–æ–¥–∑–∏' : '–î–æ–±–∞–≤–ª—è–π—Ç–µ —ç–º–æ–¥–∑–∏ –≤ –æ–ø–∏—Å–∞–Ω–∏—è'}</li>
                            <li>‚úÖ –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Å—Ç–∏–ª—å, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç</li>
                            <li>üí° <strong>–ü—Ä–µ–º–∏—É–º:</strong> –ü–æ–ª—É—á–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω</li>
                        </ul>
                    </div>
                </div>
            `;
            
            // –¢–û–ü –ü–û–°–¢–û–í
            const topPosts = data.top_posts || [];
            html += `<div class="section"><h3 class="section-title">üéØ –¢–û–ü-${Math.min(12, topPosts.length)} –ü–û–°–¢–û–í –ó–ê –ü–û–°–õ–ï–î–ù–ò–ï 12 –ú–ï–°–Ø–¶–ï–í</h3>`;
            
            if (topPosts.length > 0) {
                // üî• –ü–û–ö–ê–ó–´–í–ê–ï–ú –•–ï–®–¢–ï–ì–ò –ò –û–ü–ò–°–ê–ù–ò–Ø –î–õ–Ø –ö–ê–ñ–î–û–ì–û –ü–û–°–¢–ê
                topPosts.forEach((post, index) => {
                    const postType = post.is_video ? 'üé¨ REELS' : 'üì∑ –§–æ—Ç–æ';
                    const engagement = calculatePostEngagement(post, data.followers || 1);
                    const postHashtags = extractHashtags(post.caption || '');
                    
                    html += `
                        <div class="post-card">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                                <strong>#${index + 1} | ${postType}</strong>
                                <span style="background: #667eea; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px;">
                                    ${engagement}% –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å
                                </span>
                            </div>
                            <div style="color: #666; font-size: 14px; margin-bottom: 8px;">
                                ‚ù§Ô∏è ${(post.likes || 0).toLocaleString()} –ª–∞–π–∫–æ–≤ | üí¨ ${post.comments || 0} –∫–æ–º–º–µ–Ω—Ç–æ–≤
                            </div>
                            ${post.caption ? `
                                <div style="margin: 8px 0;">
                                    <strong>üìù –û–ø–∏—Å–∞–Ω–∏–µ:</strong>
                                    <p style="color: #555; font-style: italic; margin-top: 5px;">"${post.caption}"</p>
                                </div>
                            ` : ''}
                            ${postHashtags.length > 0 ? `
                                <div style="margin: 8px 0;">
                                    <strong>üè∑Ô∏è –•–µ—à—Ç–µ–≥–∏:</strong>
                                    <div class="hashtag-list" style="margin-top: 5px;">
                                        ${postHashtags.map(tag => `<span class="hashtag">${tag}</span>`).join('')}
                                    </div>
                                </div>
                            ` : ''}
                            <small style="color: #888;">üìÖ ${post.date || '–î–∞—Ç–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞'}</small>
                        </div>
                    `;
                });
            } else {
                html += `<p>–ü–æ—Å—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>`;
            }
            html += `</div>`;
            
            // –•–ï–®–¢–ï–ì–ò
            const hashtags = data.popular_hashtags || [];
            html += `<div class="section"><h3 class="section-title">üè∑Ô∏è –ü–û–ü–£–õ–Ø–†–ù–´–ï –•–ï–®–¢–ï–ì–ò</h3>`;
            html += `<div class="hashtag-list">`;
            
            if (hashtags.length > 0) {
                hashtags.forEach(tag => {
                    html += `<span class="hashtag">${tag}</span>`;
                });
            } else {
                html += `<p>–•–µ—à—Ç–µ–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –æ–ø–∏—Å–∞–Ω–∏—è—Ö</p>`;
            }
            html += `</div>
                <p style="margin-top: 10px; color: #666; font-size: 14px;">
                    üí° –≠—Ç–∏ —Ö–µ—à—Ç–µ–≥–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Å–∞–º—ã—Ö —É—Å–ø–µ—à–Ω—ã—Ö –ø–æ—Å—Ç–∞—Ö –∞–∫–∫–∞—É–Ω—Ç–∞
                </p>
            </div>`;
            
            results.innerHTML = html;
        }

        function displayComparisonResults(data1, data2) {
            const results = document.getElementById('results');
            
            // üî• –ë–ï–ó–û–ü–ê–°–ù–´–ô –†–ê–°–ß–ï–¢
            const score1 = calculateSuccessScore(data1);
            const score2 = calculateSuccessScore(data2);
            const engagement1 = calculateEngagementRate(data1);
            const engagement2 = calculateEngagementRate(data2);
            const avgLikes1 = calculateAvgLikes(data1.top_posts || []);
            const avgLikes2 = calculateAvgLikes(data2.top_posts || []);
            
            let html = `
                <div class="section">
                    <h3 class="section-title">‚ö° –°–†–ê–í–ù–ï–ù–ò–ï –ê–ö–ö–ê–£–ù–¢–û–í</h3>
                    
                    <div class="comparison-grid">
                        <div class="account-card">
                            <h3>@${data1.username || '–∞–∫–∫–∞—É–Ω—Ç1'} <span class="score-badge">${score1}/10</span></h3>
                            <p><strong>${data1.full_name || ''}</strong></p>
                            <div style="margin-top: 15px;">
                                <p>üë• ${(data1.followers || 0).toLocaleString()} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</p>
                                <p>üìù ${data1.posts_count || 0} –ø–æ—Å—Ç–æ–≤</p>
                                <p>‚ù§Ô∏è ${avgLikes1} –ª–∞–π–∫–æ–≤/–ø–æ—Å—Ç</p>
                                <p>üìà ${engagement1}% –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å</p>
                            </div>
                        </div>
                        
                        <div class="account-card">
                            <h3>@${data2.username || '–∞–∫–∫–∞—É–Ω—Ç2'} <span class="score-badge">${score2}/10</span></h3>
                            <p><strong>${data2.full_name || ''}</strong></p>
                            <div style="margin-top: 15px;">
                                <p>üë• ${(data2.followers || 0).toLocaleString()} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</p>
                                <p>üìù ${data2.posts_count || 0} –ø–æ—Å—Ç–æ–≤</p>
                                <p>‚ù§Ô∏è ${avgLikes2} –ª–∞–π–∫–æ–≤/–ø–æ—Å—Ç</p>
                                <p>üìà ${engagement2}% –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // üî• –í–´–í–û–î–´ –ò–ó –°–†–ê–í–ù–ï–ù–ò–Ø
            html += `
                <div class="section">
                    <h3 class="section-title">üí° –í–´–í–û–î–´ –ò–ó –°–†–ê–í–ù–ï–ù–ò–Ø</h3>
                    <div class="post-card">
                        <strong>–ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è</strong>
                        <small style="color: #666; display: block; margin-bottom: 10px;">
                            üí° –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
                        </small>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>${getComparisonInsight(data1, data2, 'followers', '–ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤')}</li>
                            <li>${getComparisonInsight(data1, data2, 'engagement', '–≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏')}</li>
                            <li>${getComparisonInsight(data1, data2, 'content', '—Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞')}</li>
                            <li>üí° <strong>–ü—Ä–µ–º–∏—É–º:</strong> –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Ä–æ—Å—Ç–∞</li>
                        </ul>
                    </div>
                </div>
            `;
            
            results.innerHTML = html;
        }

        // üî• –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ò–ó–í–õ–ï–ß–ï–ù–ò–Ø –•–ï–®–¢–ï–ì–û–í –ò–ó –¢–ï–ö–°–¢–ê
        function extractHashtags(text) {
            const hashtags = text.match(/#[\w–∞-—è–ê-–Ø]+/g) || [];
            return hashtags.slice(0, 10); // –º–∞–∫—Å–∏–º—É–º 10 —Ö–µ—à—Ç–µ–≥–æ–≤ –Ω–∞ –ø–æ—Å—Ç
        }

        // üî• –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –ê–ù–ê–õ–ò–¢–ò–ö–ò
        function calculateVideoPercentage(posts) {
            if (!posts || posts.length === 0) return 0;
            const videoPosts = posts.filter(post => post.is_video).length;
            return Math.round((videoPosts / posts.length) * 100);
        }

        function calculatePhotoPercentage(posts) {
            if (!posts || posts.length === 0) return 0;
            const photoPosts = posts.filter(post => !post.is_video).length;
            return Math.round((photoPosts / posts.length) * 100);
        }

        function calculateAvgLikes(posts) {
            if (!posts || posts.length === 0) return 0;
            const totalLikes = posts.reduce((sum, post) => sum + (post.likes || 0), 0);
            return Math.round(totalLikes / posts.length).toLocaleString();
        }

        function calculateEngagementRate(data) {
            const posts = data.top_posts || [];
            const followers = data.followers || 1;
            
            if (posts.length === 0) return '0';
            
            const totalEngagement = posts.reduce((sum, post) => sum + (post.likes || 0) + (post.comments || 0), 0);
            const avgEngagement = totalEngagement / posts.length;
            const engagementRate = (avgEngagement / followers) * 100;
            return engagementRate < 0.01 ? engagementRate.toFixed(3) : engagementRate.toFixed(2);
        }

        function calculatePostEngagement(post, followers) {
            if (!followers || followers === 0) return '0';
            const engagement = ((post.likes || 0) + (post.comments || 0)) / followers * 100;
            return engagement < 0.01 ? engagement.toFixed(3) : engagement.toFixed(2);
        }

        function getBestContentType(posts) {
            if (!posts || posts.length === 0) return '–∫–æ–Ω—Ç–µ–Ω—Ç–∞';
            const videoPosts = posts.filter(post => post.is_video);
            const photoPosts = posts.filter(post => !post.is_video);
            
            if (videoPosts.length === 0) return '—Ñ–æ—Ç–æ';
            if (photoPosts.length === 0) return '–≤–∏–¥–µ–æ';
            
            const avgVideoLikes = videoPosts.reduce((sum, post) => sum + (post.likes || 0), 0) / videoPosts.length;
            const avgPhotoLikes = photoPosts.reduce((sum, post) => sum + (post.likes || 0), 0) / photoPosts.length;
            
            return avgVideoLikes > avgPhotoLikes ? '–≤–∏–¥–µ–æ' : '—Ñ–æ—Ç–æ';
        }

        function getTopHashtags(hashtags) {
            if (!hashtags || hashtags.length === 0) return '–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –æ–ø–∏—Å–∞–Ω–∏—è –Ω–∏–∂–µ';
            return hashtags.slice(0, 3).join(', ');
        }

        function calculateSuccessScore(data) {
            const posts = data.top_posts || [];
            if (posts.length === 0) return '0';
            
            const engagementRate = parseFloat(calculateEngagementRate(data)) || 0;
            const avgLikes = parseFloat(calculateAvgLikes(posts).replace(/,/g, '')) || 0;
            const followers = data.followers || 1;
            
            const engagementScore = Math.min(engagementRate * 10, 10);
            const likesScore = Math.min(avgLikes / 10000, 10);
            const followersScore = Math.min(followers / 1000000, 10);
            
            const totalScore = (engagementScore * 0.4) + (likesScore * 0.3) + (followersScore * 0.3);
            return Math.min(10, totalScore.toFixed(1));
        }

        function analyzeCaptions(posts) {
            const captions = posts.filter(post => post.caption).map(post => post.caption);
            if (captions.length === 0) return { avg_length: 0, emoji_percentage: 0, total_analyzed: 0 };
            
            const avgLength = Math.round(captions.reduce((sum, cap) => sum + cap.length, 0) / captions.length);
            const emojiCount = captions.filter(cap => /[\u{1F300}-\u{1F5FF}\u{1F600}-\u{1F64F}]/u.test(cap)).length;
            
            return {
                avg_length: avgLength,
                emoji_percentage: Math.round((emojiCount / captions.length) * 100),
                total_analyzed: captions.length
            };
        }

        function getComparisonInsight(data1, data2, type, label) {
            const val1 = type === 'followers' ? (data1.followers || 0) : 
                        type === 'engagement' ? parseFloat(calculateEngagementRate(data1)) : 0;
            
            const val2 = type === 'followers' ? (data2.followers || 0) : 
                        type === 'engagement' ? parseFloat(calculateEngagementRate(data2)) : 0;
            
            if (type === 'content') {
                const type1 = getBestContentType(data1.top_posts || []);
                const type2 = getBestContentType(data2.top_posts || []);
                return `@${data1.username} –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ${type1} –∫–æ–Ω—Ç–µ–Ω—Ç, –∞ @${data2.username} - ${type2}`;
            }
            
            if (val2 === 0) return `–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è`;
            
            const diff = ((val1 - val2) / val2 * 100).toFixed(1);
            if (Math.abs(diff) < 10) return `–ü–æ ${label} –∞–∫–∫–∞—É–Ω—Ç—ã –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–Ω—ã`;
            
            const leader = diff > 0 ? data1.username : data2.username;
            return `@${leader} –ª–∏–¥–∏—Ä—É–µ—Ç –ø–æ ${label} –Ω–∞ ${Math.abs(diff)}%`;
        }

        // üî• –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ê–ù–ê–õ–ò–ó–ê –î–ê–¢
        function analyzePostTiming(posts) {
            if (!posts || posts.length === 0) {
                return {
                    posts_stats: '<p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</p>',
                    days_analysis: '<p>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö</p>',
                    months_analysis: '<p>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö</p>',
                    content_analysis: '<p>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö</p>',
                    days_recommendation: '<ul><li>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</li></ul>',
                    content_recommendation: '<ul><li>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</li></ul>',
                    season_recommendation: '<ul><li>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</li></ul>'
                };
            }

            const daysStats = {};
            const monthsStats = {};
            const contentByDay = {};
            
            // üî• –ò–ù–ò–¶–ò–ê–õ–ò–ó–ò–†–£–ï–ú –í–°–ï 12 –ú–ï–°–Ø–¶–ï–í
            const monthNames = ['—è–Ω–≤–∞—Ä—å', '—Ñ–µ–≤—Ä–∞–ª—å', '–º–∞—Ä—Ç', '–∞–ø—Ä–µ–ª—å', '–º–∞–π', '–∏—é–Ω—å', '–∏—é–ª—å', '–∞–≤–≥—É—Å—Ç', '—Å–µ–Ω—Ç—è–±—Ä—å', '–æ–∫—Ç—è–±—Ä—å', '–Ω–æ—è–±—Ä—å', '–¥–µ–∫–∞–±—Ä—å'];
            monthNames.forEach(month => {
                monthsStats[month] = 0;
            });
            
            // üî• –ê–ù–ê–õ–ò–ó –î–ê–¢
            posts.forEach((post, index) => {
                if (post.date) {
                    try {
                        const [day, month, year] = post.date.split('.').map(Number);
                        
                        if (day && month && year && month >= 1 && month <= 12) {
                            const date = new Date(year, month - 1, day);
                            
                            if (!isNaN(date.getTime())) {
                                const dayOfWeek = date.getDay();
                                const monthNum = date.getMonth();
                                
                                const dayNames = ['–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ', '–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–≤—Ç–æ—Ä–Ω–∏–∫', '—Å—Ä–µ–¥–∞', '—á–µ—Ç–≤–µ—Ä–≥', '–ø—è—Ç–Ω–∏—Ü–∞', '—Å—É–±–±–æ—Ç–∞'];
                                const monthName = monthNames[monthNum];
                                
                                const dayName = dayNames[dayOfWeek];
                                
                                // –°–æ–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                                daysStats[dayName] = (daysStats[dayName] || 0) + 1;
                                monthsStats[monthName] = (monthsStats[monthName] || 0) + 1;
                                
                                // –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ –¥–Ω—è–º
                                if (!contentByDay[dayName]) {
                                    contentByDay[dayName] = { video: 0, photo: 0 };
                                }
                                if (post.is_video) {
                                    contentByDay[dayName].video++;
                                } else {
                                    contentByDay[dayName].photo++;
                                }
                            }
                        }
                    } catch (e) {
                        console.log('–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞—Ç—ã:', e);
                    }
                }
            });

            // üî• –§–û–†–ú–ò–†–£–ï–ú –°–¢–ê–¢–ò–°–¢–ò–ö–£ –ü–û–°–¢–û–í –° –•–ï–®–¢–ï–ì–ê–ú–ò –ò –û–ü–ò–°–ê–ù–ò–Ø–ú–ò
            let postsStats = '';
            const displayedPosts = posts.slice(0, 12); // üî• –ü–û–ö–ê–ó–´–í–ê–ï–ú –¢–û–õ–¨–ö–û 12 –ü–û–°–¢–û–í
            
            displayedPosts.forEach((post, index) => {
                if (post.date) {
                    try {
                        const [day, month, year] = post.date.split('.').map(Number);
                        if (day && month && year && month >= 1 && month <= 12) {
                            const date = new Date(year, month - 1, day);
                            
                            if (!isNaN(date.getTime())) {
                                const dayNames = ['–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ', '–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–≤—Ç–æ—Ä–Ω–∏–∫', '—Å—Ä–µ–¥–∞', '—á–µ—Ç–≤–µ—Ä–≥', '–ø—è—Ç–Ω–∏—Ü–∞', '—Å—É–±–±–æ—Ç–∞'];
                                const dayName = dayNames[date.getDay()];
                                const postType = post.is_video ? '–≤–∏–¥–µ–æ' : '—Ñ–æ—Ç–æ';
                                const postHashtags = extractHashtags(post.caption || '');
                                
                                postsStats += `
                                    <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #eee;">
                                        <strong>–ü–æ—Å—Ç ${index + 1}: ${post.date} (${dayName})</strong><br>
                                        <span style="color: #666;">${postType} | ${(post.likes || 0).toLocaleString()} –ª–∞–π–∫–æ–≤</span>
                                        ${post.caption ? `
                                            <div style="margin-top: 5px;">
                                                <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> 
                                                <span style="color: #555;">${post.caption.substring(0, 100)}${post.caption.length > 100 ? '...' : ''}</span>
                                            </div>
                                        ` : ''}
                                        ${postHashtags.length > 0 ? `
                                            <div style="margin-top: 5px;">
                                                <strong>–•–µ—à—Ç–µ–≥–∏:</strong> 
                                                <span style="color: #667eea;">${postHashtags.slice(0, 3).join(', ')}</span>
                                            </div>
                                        ` : ''}
                                    </div>
                                `;
                            }
                        }
                    } catch (e) {
                        const postType = post.is_video ? '–≤–∏–¥–µ–æ' : '—Ñ–æ—Ç–æ';
                        postsStats += `<p>–ü–æ—Å—Ç ${index + 1}: ${post.date} - ${(post.likes || 0).toLocaleString()} –ª–∞–π–∫–æ–≤ | ${postType}</p>`;
                    }
                } else {
                    const postType = post.is_video ? '–≤–∏–¥–µ–æ' : '—Ñ–æ—Ç–æ';
                    postsStats += `<p>–ü–æ—Å—Ç ${index + 1}: –î–∞—Ç–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞ - ${(post.likes || 0).toLocaleString()} –ª–∞–π–∫–æ–≤ | ${postType}</p>`;
                }
            });

            // üî• –ê–ù–ê–õ–ò–ó –î–ù–ï–ô –ù–ï–î–ï–õ–ò –° –¢–ò–ü–ê–ú–ò –ö–û–ù–¢–ï–ù–¢–ê
            let daysAnalysis = '';
            if (Object.keys(daysStats).length > 0) {
                Object.entries(daysStats)
                    .sort((a, b) => b[1] - a[1])
                    .forEach(([day, count]) => {
                        const percentage = Math.round((count / posts.length) * 100);
                        const dayContent = contentByDay[day] || { video: 0, photo: 0 };
                        const contentTypes = [];
                        if (dayContent.video > 0) contentTypes.push(`${dayContent.video} –≤–∏–¥–µ–æ`);
                        if (dayContent.photo > 0) contentTypes.push(`${dayContent.photo} —Ñ–æ—Ç–æ`);
                        
                        daysAnalysis += `<p><strong>${day.charAt(0).toUpperCase() + day.slice(1)}</strong>: ${count} —Ç–æ–ø-–ø–æ—Å—Ç–∞ (${percentage}%) - ${contentTypes.join(', ')}</p>`;
                    });
            } else {
                daysAnalysis = '<p>–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏</p>';
            }

            // üî• –ê–ù–ê–õ–ò–ó –í–°–ï–• 12 –ú–ï–°–Ø–¶–ï–í
            let monthsAnalysis = '<div class="month-stats">';
            monthNames.forEach(month => {
                const count = monthsStats[month] || 0;
                const isActive = count > 0;
                monthsAnalysis += `
                    <div class="month-item ${isActive ? 'active' : ''}">
                        <div style="font-weight: bold;">${month.charAt(0).toUpperCase() + month.slice(1)}</div>
                        <div>${count} –ø–æ—Å—Ç${count !== 1 ? '–æ–≤' : ''}</div>
                    </div>
                `;
            });
            monthsAnalysis += '</div>';

            // üî• –ê–ù–ê–õ–ò–ó –ö–û–ù–¢–ï–ù–¢–ê –ü–û –î–ù–Ø–ú
            let contentAnalysis = '';
            if (Object.keys(contentByDay).length > 0) {
                Object.entries(contentByDay).forEach(([day, stats]) => {
                    contentAnalysis += `<p><strong>${day.charAt(0).toUpperCase() + day.slice(1)}</strong>: ${stats.video} –≤–∏–¥–µ–æ, ${stats.photo} —Ñ–æ—Ç–æ</p>`;
                });
            } else {
                contentAnalysis = '<p>–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ –¥–Ω—è–º</p>';
            }

            // üî• –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò
            const topDays = Object.entries(daysStats).sort((a, b) => b[1] - a[1]).slice(0, 2);
            const topMonths = Object.entries(monthsStats).sort((a, b) => b[1] - a[1]).slice(0, 3);

            let daysRecommendation = '<ul>';
            if (topDays.length > 0) {
                topDays.forEach(([day, count]) => {
                    const percentage = Math.round((count / posts.length) * 100);
                    daysRecommendation += `<li><strong>${day.toUpperCase()}</strong> - ${percentage}% —É—Å–ø–µ—à–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤</li>`;
                });
            } else {
                daysRecommendation += '<li><strong>–ü–û–ù–ï–î–ï–õ–¨–ù–ò–ö</strong> - –ª—É—á—à–∏–π –¥–µ–Ω—å –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ –Ω–µ–¥–µ–ª–∏</li>';
                daysRecommendation += '<li><strong>–ü–Ø–¢–ù–ò–¶–ê</strong> - –ø–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–Ω—ã–º–∏</li>';
            }
            daysRecommendation += '</ul>';

            let contentRecommendation = '<ul>';
            if (topDays.length > 0) {
                topDays.forEach(([day]) => {
                    const dayContent = contentByDay[day] || { video: 0, photo: 0 };
                    const mainContentType = dayContent.video > dayContent.photo ? '–≤–∏–¥–µ–æ –∫–æ–Ω—Ç–µ–Ω—Ç (Reels)' : '—Ñ–æ—Ç–æ –∫–æ–Ω—Ç–µ–Ω—Ç';
                    contentRecommendation += `<li><strong>${day.charAt(0).toUpperCase() + day.slice(1)}</strong>: ${mainContentType}</li>`;
                });
            } else {
                contentRecommendation += '<li><strong>–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫-—Å—Ä–µ–¥–∞</strong>: –≤–∏–¥–µ–æ –∫–æ–Ω—Ç–µ–Ω—Ç (Reels)</li>';
                contentRecommendation += '<li><strong>–ß–µ—Ç–≤–µ—Ä–≥-–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ</strong>: —Ñ–æ—Ç–æ –∫–æ–Ω—Ç–µ–Ω—Ç</li>';
            }
            contentRecommendation += '</ul>';

            let seasonRecommendation = '<ul>';
            if (topMonths.length > 0) {
                topMonths.forEach(([month, count]) => {
                    if (count > 0) {
                        seasonRecommendation += `<li><strong>${month.toUpperCase()}</strong>: ${count} —É—Å–ø–µ—à–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤</li>`;
                        
                        // –°–µ–∑–æ–Ω–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –¥–ª—è –í–°–ï–• 12 –º–µ—Å—è—Ü–µ–≤
                        if (['–º–∞—Ä—Ç', '–∞–ø—Ä–µ–ª—å', '–º–∞–π'].includes(month)) {
                            seasonRecommendation += `<li>üå± –í–µ—Å–Ω–∞: +45% –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏</li>`;
                        } else if (['–∏—é–Ω—å', '–∏—é–ª—å', '–∞–≤–≥—É—Å—Ç'].includes(month)) {
                            seasonRecommendation += `<li>‚òÄÔ∏è –õ–µ—Ç–æ: –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è +120%</li>`;
                        } else if (['—Å–µ–Ω—Ç—è–±—Ä—å', '–æ–∫—Ç—è–±—Ä—å', '–Ω–æ—è–±—Ä—å'].includes(month)) {
                            seasonRecommendation += `<li>üçÇ –û—Å–µ–Ω—å: —É—é—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç +60%</li>`;
                        } else if (['–¥–µ–∫–∞–±—Ä—å', '—è–Ω–≤–∞—Ä—å', '—Ñ–µ–≤—Ä–∞–ª—å'].includes(month)) {
                            seasonRecommendation += `<li>‚õÑÔ∏è –ó–∏–º–∞: –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç +80%</li>`;
                        }
                    }
                });
            } else {
                seasonRecommendation += '<li>üìä –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ç–µ–Ω—Ç –µ–∂–µ–º–µ—Å—è—á–Ω–æ</li>';
                seasonRecommendation += '<li>üéØ –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã</li>';
            }
            seasonRecommendation += '</ul>';

            return {
                posts_stats: postsStats || '<p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ—Å—Ç–∞—Ö</p>',
                days_analysis: daysAnalysis,
                months_analysis: monthsAnalysis,
                content_analysis: contentAnalysis,
                days_recommendation: daysRecommendation,
                content_recommendation: contentRecommendation,
                season_recommendation: seasonRecommendation
            };
        }

        function showMessage(message, type) {
            const results = document.getElementById('results');
            results.innerHTML = `<div class="${type}">${message}</div>`;
        }

        // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ Enter
        document.getElementById('username')?.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') analyzeAccount();
        });
        
        document.getElementById('username1')?.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') compareAccounts();
        });
        
        document.getElementById('username2')?.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') compareAccounts();
        });
    </script>
</body>
</html>
